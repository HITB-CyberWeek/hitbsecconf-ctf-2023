Легенда
Сервис по хранению лицензионных ключей для компании.
Ключи к софту дорогие, сотрудники их воруют и продают на сторону.
Поэтому этот сервис позволяет сохранить ключи удаленно, а клиенту выдать
некоторую строчку-токен, которая будет вбиваться им вместо ключа (предполагается,
что на стороне клиента есть некий активатор, умеющий с этим токеном работать)
По токену можно получить лицензионный ключ. Поэтому клиент не работает
с самим ключом, а работает с токеном, вбивает его в форму какую-то у себя и
активатор сам регает лицензию у клиента.

Клиент-компания COMP1 приходит на сервис и оставляет для своей компании
лицензионный ключ LIC1 для некоторого продукта. Сервис выдает токен TOK1.
Далее приходит клиентская программа, предоставляет TOK1, по нему получает
LIC1.
TOK1 - это Hash1(COMP1), зная COMP1 можно узнать TOK1, по нему получать LIC1
Чтобы нельзя было тупо все выпилить, TOK1 подписывается.
TOK1 = Hash1(COMP1) + Hash2(secret+Hash1(COMP1))
Жюрейка проверяет, что цифровая подпись корректна.
Атака:
Узнаем алгоритм и теперь умеем по COMP1 и secret генерировать TOK1.
Можем запрашивать все лицензии
Защита:
Hash1(COMP1) меняем на просто рандомную строчку.
Hash1, Hash2, secret находятся внутри обфусцированного модуля и их нужно разреверсить.
В базе сохраняется TOK1,LIC1 и COMP (COMP=flagid,LIC1=flag).
